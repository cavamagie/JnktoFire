import groovy.json.JsonOutput
pipeline {
    agent any
    stages {
        stage('Vars') {
          steps {
            script {
              writeFile file: 'params.json', text: JsonOutput.toJson(params)
              echo sh(returnStdout: true, script: 'env')

            }
          }
        }
        stage('Build') {
            agent {
                docker {
                    image params.Images
                    args "-u root:root"
                    reuseNode true
                }
                }
   
            steps {
                sh 'pwd'
   
                shell "whoami"
                sh " git clone https://github.ibm.com/Luigi-Molinaro/fyre-automation.git"
                sh "ls"       
                sh "ansible-playbook Playbook.yaml -v -e \"@params.json\""
            }

                }
            }
        }

